<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emily Miller">
<meta name="dcterms.date" content="2025-11-29">
<meta name="description" content="Using a hurdle model to understand roadkill patterns on Danish roads">

<title>Traffic, Land Use, and Wildlife-Vehicle Collisions in Denmark – Emily Miller</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-bee60ecf57315cb3986c6e19731cdde6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Emily Miller</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bona-fides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Bona Fides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bona-fides">    
        <li>
    <a class="dropdown-item" href="../../research.html">
 <span class="dropdown-text">Research</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../cv.html">
 <span class="dropdown-text">Resume</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-creative" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Creative</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-creative">    
        <li>
    <a class="dropdown-item" href="../../art.html">
 <span class="dropdown-text">Art &amp; Poetry</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../adventures.html">
 <span class="dropdown-text">Adventures</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rellimylime"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Traffic, Land Use, and Wildlife-Vehicle Collisions in Denmark</h1>
                  <div>
        <div class="description">
          Using a hurdle model to understand roadkill patterns on Danish roads
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">MEDS</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">Wildlife</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Emily Miller </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 29, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-why-this-matters" id="toc-introduction-why-this-matters" class="nav-link active" data-scroll-target="#introduction-why-this-matters">1. Introduction: Why This Matters</a>
  <ul class="collapse">
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><strong>Research Question</strong></a></li>
  </ul></li>
  <li><a href="#building-a-theory-what-causes-roadkill" id="toc-building-a-theory-what-causes-roadkill" class="nav-link" data-scroll-target="#building-a-theory-what-causes-roadkill">2. Building a Theory: What Causes Roadkill?</a>
  <ul class="collapse">
  <li><a href="#the-causal-story" id="toc-the-causal-story" class="nav-link" data-scroll-target="#the-causal-story"><strong>The Causal Story</strong></a></li>
  <li><a href="#visualizing-causal-relationships-the-dag" id="toc-visualizing-causal-relationships-the-dag" class="nav-link" data-scroll-target="#visualizing-causal-relationships-the-dag"><strong>Visualizing Causal Relationships: The DAG</strong></a></li>
  </ul></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">3. Hypothesis</a></li>
  <li><a href="#data-methods" id="toc-data-methods" class="nav-link" data-scroll-target="#data-methods">4. Data &amp; Methods</a>
  <ul class="collapse">
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources">Data Sources</a></li>
  <li><a href="#data-processing-pipeline" id="toc-data-processing-pipeline" class="nav-link" data-scroll-target="#data-processing-pipeline">Data Processing Pipeline</a></li>
  </ul></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">5. Exploratory Analysis</a></li>
  <li><a href="#statistical-model-the-hurdle-approach" id="toc-statistical-model-the-hurdle-approach" class="nav-link" data-scroll-target="#statistical-model-the-hurdle-approach">6. Statistical Model: The Hurdle Approach</a>
  <ul class="collapse">
  <li><a href="#why-a-hurdle-model" id="toc-why-a-hurdle-model" class="nav-link" data-scroll-target="#why-a-hurdle-model">Why a Hurdle Model?</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification">Model Specification</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">7. Results</a>
  <ul class="collapse">
  <li><a href="#fit-model-to-real-data" id="toc-fit-model-to-real-data" class="nav-link" data-scroll-target="#fit-model-to-real-data">Fit Model to Real Data</a></li>
  <li><a href="#model-coefficients" id="toc-model-coefficients" class="nav-link" data-scroll-target="#model-coefficients">Model Coefficients</a></li>
  <li><a href="#model-fit-to-data" id="toc-model-fit-to-data" class="nav-link" data-scroll-target="#model-fit-to-data">Model Fit to Data</a></li>
  <li><a href="#model-fit-separating-occurrence-from-intensity" id="toc-model-fit-separating-occurrence-from-intensity" class="nav-link" data-scroll-target="#model-fit-separating-occurrence-from-intensity">Model Fit: Separating Occurrence from Intensity</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">8. Discussion</a>
  <ul class="collapse">
  <li><a href="#summary-of-findings" id="toc-summary-of-findings" class="nav-link" data-scroll-target="#summary-of-findings">Summary of Findings</a></li>
  <li><a href="#policy-implications" id="toc-policy-implications" class="nav-link" data-scroll-target="#policy-implications">Policy Implications</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="introduction-why-this-matters" class="level1">
<h1>1. Introduction: Why This Matters</h1>
<p>Wildlife-vehicle collisions threaten biodiversity and pose safety risks. Understanding which road and landscape characteristics predict roadkill hotspots enables evidence-based mitigation. We analyze ~11,000 roadkill events on 241,000 Danish road segments (2017-2019) to test whether traffic volume, forest proximity, and urban development predict collision rates.</p>
<p><strong>The puzzle</strong>: Some roads experience frequent wildlife collisions while others have zero incidents. Is it just random chance or collection bias? Or are there systematic patterns we can identify and address?</p>
<p>If we can predict which roads are most likely to become collision hotspots, transportation planners and conservationists can install wildlife crossings, implement warning systems, or adjust speed limits in high-risk areas.</p>
<section id="research-question" class="level3">
<h3 class="anchored" data-anchor-id="research-question"><strong>Research Question</strong></h3>
<p><strong>How do traffic volume and land use characteristics affect wildlife-vehicle collisions on Danish roads?</strong></p>
<p>Specifically, we investigate two processes:</p>
<ol type="1">
<li><strong>Occurrence</strong>: What makes roadkill more likely to happen at all on a given road segment?</li>
<li><strong>Intensity</strong>: Once roadkill does occur, what factors influence how many collision events happen?</li>
</ol>
<p>The high proportion of road segments with zero observed roadkill (~83%) suggests these processes operate differently, making a hurdle model the appropriate statistical framework.</p>
</section>
</section>
<section id="building-a-theory-what-causes-roadkill" class="level1">
<h1>2. Building a Theory: What Causes Roadkill?</h1>
<section id="the-causal-story" class="level3">
<h3 class="anchored" data-anchor-id="the-causal-story"><strong>The Causal Story</strong></h3>
<p>Imagine you’re a deer deciding whether to cross a road. Several factors affect your collision risk:</p>
<ol type="1">
<li><strong>Traffic volume</strong>: More vehicles = more chances for collision</li>
<li><strong>Your habitat</strong>: You’re more likely to be near roads that pass through forests or parks</li>
<li><strong>Road characteristics</strong>: Wider, faster roads are harder to cross safely</li>
<li><strong>Human development</strong>: You avoid heavily urbanized areas</li>
</ol>
</section>
<section id="visualizing-causal-relationships-the-dag" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-causal-relationships-the-dag"><strong>Visualizing Causal Relationships: The DAG</strong></h3>
<p>Now, let’s formalize our deer’s decision-making process with a Directed Acyclic Graph (DAG).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/dag-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key relationships:</strong></p>
<ul>
<li><strong>Traffic (AADT)</strong> directly affects roadkill probability (more vehicles → more collision opportunities)</li>
<li><strong>Land use</strong> influences wildlife presence near roads (forests/parks attract wildlife) as well as road types</li>
<li><strong>Road type</strong> is a common cause affecting traffic volume, and speed limits</li>
<li><strong>Speed limit</strong> affects collision severity and driver reaction time</li>
<li>We control for <strong>road type</strong> to avoid confounding when estimating traffic effects</li>
</ul>
<p><strong>NOTE</strong>: Without considering wildlife density and surrounding habitats, this model estimates relationships conditional on unobserved wildlife presence, which is approximated using nearby land-use rather than direct population data.</p>
<hr>
</section>
</section>
<section id="hypothesis" class="level1">
<h1>3. Hypothesis</h1>
<p>Based on our causal theory, we make three sets of predictions:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Hypothesis</th>
<th>Variable</th>
<th>Expected Effect</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>H1: Traffic</strong></td>
<td>AADT (↑)</td>
<td>+ occurrence, + intensity</td>
<td>More vehicles → more collision opportunities</td>
</tr>
<tr class="even">
<td><strong>H2a: Wildlife habitat</strong></td>
<td>Forest/Park (↑)</td>
<td>+ occurrence, + intensity</td>
<td>Attracts wildlife near roads</td>
</tr>
<tr class="odd">
<td><strong>H2b: Urban development</strong></td>
<td>Residential (↑)</td>
<td>- occurrence, - intensity</td>
<td>Reduces wildlife presence</td>
</tr>
<tr class="even">
<td><strong>H3a: Road infrastructure</strong></td>
<td>Major roads (vs Major baseline)</td>
<td>- occurrence, - intensity</td>
<td>Lower speeds, fewer lanes than major roads</td>
</tr>
<tr class="odd">
<td><strong>H3b: Speed</strong></td>
<td>Speed limit (↑)</td>
<td>+ occurrence, + intensity</td>
<td>Reduced reaction time, higher mortality</td>
</tr>
</tbody>
</table>
<p>We’ll test this in <em>both</em> parts of our model:</p>
<p><strong>Note:</strong> All effects are interpreted as rates per km (controlled via offset for road length).</p>
<hr>
</section>
<section id="data-methods" class="level1">
<h1>4. Data &amp; Methods</h1>
<section id="data-sources" class="level3">
<h3 class="anchored" data-anchor-id="data-sources">Data Sources</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Dataset</th>
<th>Source</th>
<th>Variables</th>
<th>Coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Roadkill observations</td>
<td>Global Roadkill Database <span class="citation" data-cites="grilo2025">(<a href="#ref-grilo2025" role="doc-biblioref">Grilo et al. 2025</a>)</span></td>
<td>GPS coordinates, species</td>
<td>2017-2019</td>
</tr>
<tr class="even">
<td>Road network</td>
<td>OpenStreetMap <span class="citation" data-cites="osm2024">(<a href="#ref-osm2024" role="doc-biblioref">OpenStreetMap contributors 2024</a>)</span></td>
<td>Geometry, type, speed limits</td>
<td>Denmark</td>
</tr>
<tr class="odd">
<td>Traffic counts</td>
<td>Danish Road Directorate <span class="citation" data-cites="vejdirektoratet2019">(<a href="#ref-vejdirektoratet2019" role="doc-biblioref">Danish Road Directorate 2017--2019</a>)</span></td>
<td>AADT (vehicles/day)</td>
<td>Monitoring stations</td>
</tr>
<tr class="even">
<td>Land use</td>
<td>OpenStreetMap <span class="citation" data-cites="osm2024">(<a href="#ref-osm2024" role="doc-biblioref">OpenStreetMap contributors 2024</a>)</span></td>
<td>Forest, farmland, residential, parks</td>
<td>500m buffers</td>
</tr>
</tbody>
</table>
<p>Technical Setup: [<code>tidyverse</code>, <code>sf</code>, <code>terra</code>, <code>here</code>, <code>pscl</code>, <code>yaml</code>, <code>patchwork</code>, <code>dagitty</code>, <code>ggdag</code>]</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load configuration</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">read_yaml</span>(<span class="fu">here</span>(<span class="st">"posts/eds222-final/config.yml"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(config<span class="sc">$</span>seed)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>CRS_M <span class="ot">&lt;-</span> config<span class="sc">$</span>crs <span class="co"># EPSG:25832, Denmark ETRS89 / UTM zone 32N</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Denmark bounding box (WGS84)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>dk_bbox_wgs84 <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">xmin =</span> config<span class="sc">$</span>bbox_xmin,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymin =</span> config<span class="sc">$</span>bbox_ymin,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">xmax =</span> config<span class="sc">$</span>bbox_xmax,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymax =</span> config<span class="sc">$</span>bbox_ymax</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>), <span class="at">crs =</span> config<span class="sc">$</span>bbox_crs)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to projected CRS</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>dk_bbox_proj <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(<span class="fu">st_as_sfc</span>(dk_bbox_wgs84), CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_bbox</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="load-roadkill-observations" class="level4">
<h4 class="anchored" data-anchor-id="load-roadkill-observations">Load Roadkill Observations</h4>
<p>Roadkill observations are GPS point locations filtered to Denmark and the study period (2017-2019), then transformed to a projected coordinate system (EPSG:4326) for analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load roadkill CSV</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>road_kill_dk <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(config<span class="sc">$</span>roadkill_csv_path)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"Denmark"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">&gt;=</span> <span class="dv">2017</span>, year <span class="sc">&lt;=</span> <span class="dv">2019</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(decimalLongitude, decimalLatitude) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"decimalLongitude"</span>, <span class="st">"decimalLatitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_crop</span>(dk_bbox_proj)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<blockquote class="blockquote">
<ul>
<li>Roadkill observations: 16,237</li>
<li>Time period: 2017-2019</li>
<li>Coordinate system: ETRS89 / UTM zone 32N</li>
</ul>
</blockquote>
</section>
<section id="load-road-network" class="level4">
<h4 class="anchored" data-anchor-id="load-road-network">Load Road Network</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cache path for roads data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>roads_cache <span class="ot">&lt;-</span> <span class="fu">here</span>(config<span class="sc">$</span>roads_cached_path)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(roads_cache)) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Loading roads from cache...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  roads_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(roads_cache)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache not found. Loading and processing roads (one-time setup)...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load shapefile</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  roads_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">here</span>(config<span class="sc">$</span>roads_shp_path), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_crop</span>(dk_bbox_proj)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save to cache</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Saving roads to cache for future runs...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(roads_raw, roads_cache)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache saved:"</span>, roads_cache, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<blockquote class="blockquote">
<p>Road segments loaded: 1,327,815</p>
</blockquote>
</section>
<section id="load-traffic-data" class="level4">
<h4 class="anchored" data-anchor-id="load-traffic-data">Load Traffic Data</h4>
<p>Traffic counts represent Annual Average Daily Traffic (AADT) from monitoring stations, averaged across 2017-2019.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cache path for traffic data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>traffic_cache <span class="ot">&lt;-</span> <span class="fu">here</span>(config<span class="sc">$</span>traffic_cached_path)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(traffic_cache)) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Loading traffic data from cache...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  traffic_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(traffic_cache)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache not found. Loading and processing traffic (one-time setup)...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load shapefile</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  traffic_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">here</span>(config<span class="sc">$</span>traffic_shp_path), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_crop</span>(dk_bbox_proj) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AAR <span class="sc">&gt;=</span> <span class="dv">2017</span>, AAR <span class="sc">&lt;=</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average AADT across years for each station</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">AADT =</span> <span class="fu">mean</span>(AADT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">AAR =</span> <span class="st">"2017-2019"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save to cache</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Saving traffic to cache for future runs...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(traffic_raw, traffic_cache)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache saved:"</span>, traffic_cache, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<blockquote class="blockquote">
<p>Traffic monitoring stations: 3,000</p>
</blockquote>
</section>
<section id="load-land-use-data" class="level4">
<h4 class="anchored" data-anchor-id="load-land-use-data">Load Land Use Data</h4>
<p>Land use polygons classify areas as forest, farmland, residential, parks, etc.</p>
<blockquote class="blockquote">
<p>Land use polygons: 587,311</p>
</blockquote>
<p>Top land use classes:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 10 Land Use Classes</caption>
<thead>
<tr class="header">
<th style="text-align: left;">fclass</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">farmland</td>
<td style="text-align: right;">149854</td>
</tr>
<tr class="even">
<td style="text-align: left;">forest</td>
<td style="text-align: right;">141814</td>
</tr>
<tr class="odd">
<td style="text-align: left;">farmyard</td>
<td style="text-align: right;">84400</td>
</tr>
<tr class="even">
<td style="text-align: left;">meadow</td>
<td style="text-align: right;">72662</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scrub</td>
<td style="text-align: right;">55374</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">40029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">residential</td>
<td style="text-align: right;">20427</td>
</tr>
<tr class="even">
<td style="text-align: left;">heath</td>
<td style="text-align: right;">5948</td>
</tr>
<tr class="odd">
<td style="text-align: left;">park</td>
<td style="text-align: right;">5540</td>
</tr>
<tr class="even">
<td style="text-align: left;">industrial</td>
<td style="text-align: right;">3310</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Computational Note</strong>: These shapefiles are large (millions of features); we cache the processed/projected versions to avoid reloading and processing during every run. First runs take ~5-10 minutes each; cached runs take seconds.</p>
<hr>
</section>
</section>
<section id="data-processing-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="data-processing-pipeline">Data Processing Pipeline</h3>
<section id="filter-to-motorized-roads" class="level4">
<h4 class="anchored" data-anchor-id="filter-to-motorized-roads">Filter to Motorized Roads</h4>
<p>We restrict analysis to roads accessible by motor vehicles, excluding pedestrian paths and cycleways and other places where wildlife-vehicle collisions cannot occur.</p>
<blockquote class="blockquote">
<ul>
<li>Motorized road segments: 322,776</li>
<li>Total road length: 97,822 km</li>
<li>Mean segment length: 0.3 km</li>
</ul>
</blockquote>
</section>
<section id="match-traffic-to-road-segments" class="level4">
<h4 class="anchored" data-anchor-id="match-traffic-to-road-segments">Match Traffic to Road Segments</h4>
<p>Traffic monitoring stations are point locations. Since there are far more roads than monitoring stations, I assigned each road segment with the AADT from its nearest station, applying a distance threshold. This means we only assign traffic data to roads within ~3.7 km of a monitoring station, avoiding matches to stations that are unreasonably far away. This balances <strong>coverage</strong> (75% of roads get traffic data) with <strong>accuracy</strong> (avoiding spurious long-distance matches).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply configured threshold</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>threshold_percentile <span class="ot">&lt;-</span> config<span class="sc">$</span>distance_threshold_percentile</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dist_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">as.numeric</span>(distances), threshold_percentile)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge traffic data with roads</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>roads_traf <span class="ot">&lt;-</span> car_roads <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">nn_dist_m =</span> <span class="fu">as.numeric</span>(distances),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">AADT =</span> <span class="fu">if_else</span>(nn_dist_m <span class="sc">&lt;=</span> dist_threshold,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                   traffic_raw<span class="sc">$</span>AADT[nearest_idx],</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                   <span class="cn">NA_real_</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<blockquote class="blockquote">
<ul>
<li>Distance threshold: 3,699 m (75th percentile)</li>
<li>Roads with traffic data: 242,082 (75%)</li>
<li>AADT range: 0 - 59,632 vehicles/day</li>
</ul>
</blockquote>
<p><strong>Note</strong>: Analysis is limited to Denmark’s <em>monitored</em> road network (major highways and urban roads). Remote rural roads are likely not included.</p>
<hr>
</section>
<section id="extract-land-use-around-roads" class="level4">
<h4 class="anchored" data-anchor-id="extract-land-use-around-roads">Extract Land Use Around Roads</h4>
<p>We calculate the percentage of forest, farmland, residential, and park land use within 500m buffers around each road segment. This distance approximates wildlife movement ranges and habitat edge effects.</p>
<p>Mean land use composition within 500m:</p>
<blockquote class="blockquote">
<ul>
<li>Forest: 11.2%</li>
<li>Farmland: 31.9%</li>
<li>Residential: 44.5%</li>
<li>Parks: 4.6%</li>
</ul>
</blockquote>
</section>
<section id="aggregate-roadkill-by-road-segment" class="level4">
<h4 class="anchored" data-anchor-id="aggregate-roadkill-by-road-segment">Aggregate Roadkill by Road Segment</h4>
<p>Each roadkill point is matched to its nearest road segment using spatial join.</p>
<blockquote class="blockquote">
<ul>
<li>Road segments with roadkill: 10,095</li>
</ul>
</blockquote>
</section>
<section id="create-final-analysis-dataset" class="level4">
<h4 class="anchored" data-anchor-id="create-final-analysis-dataset">Create Final Analysis Dataset</h4>
<p>We merge all data sources and apply transformations required for modeling: log-transform traffic and road length, classify road types, and assign missing speed limits.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Final Dataset Characteristics</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Road segments</td>
<td style="text-align: left;">241,765</td>
</tr>
<tr class="even">
<td style="text-align: left;">Segments with roadkill</td>
<td style="text-align: left;">6,850 (2.8%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zero-inflation rate</td>
<td style="text-align: left;">97.2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total roadkill events</td>
<td style="text-align: left;">10,834</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean roadkill per segment</td>
<td style="text-align: left;">0.045</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overdispersion (Var/Mean)</td>
<td style="text-align: left;">2.71</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Key observations</strong>:</p>
<blockquote class="blockquote">
<ul>
<li>High zero-inflation (97.2%) justifies hurdle model</li>
<li>Overdispersion (Var/Mean = 2.71) justifies negative binomial distribution</li>
</ul>
</blockquote>
<hr>
</section>
</section>
</section>
<section id="exploratory-analysis" class="level1">
<h1>5. Exploratory Analysis</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Visualizations</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Key patterns</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><img src="eda_visualization_themed2.png" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ol type="1">
<li><strong>Panel A (roadkill distribution)</strong>: Massive spike at zero (83% of segments) confirms high zero-inflation, with remaining segments showing right-skewed counts</li>
<li><strong>Panel B (traffic vs roadkill)</strong>: Clear positive relationship - higher AADT correlates with more roadkill events (visible trend in hexbin density)</li>
<li><strong>Panel C (road type)</strong>: Major roads show higher roadkill counts than minor roads among segments with at least one event</li>
<li><strong>Panel D (road length)</strong>: Longer segments accumulate more events, confirming the need for a length offset in our model</li>
<li><strong>Predictor distributions</strong>: Traffic volume and road length are log-normally distributed; speed limits are bimodal (~50 km/h or missing); road network is dominated by Minor roads; land use shows farmland dominance with high variability in forest, residential, and park coverage</li>
</ol>
</div>
</div>
</div>
<p>These patterns validate our hypotheses from the DAG. Now let’s build a statistical model to quantify these effects.</p>
<hr>
</section>
<section id="statistical-model-the-hurdle-approach" class="level1">
<h1>6. Statistical Model: The Hurdle Approach</h1>
<section id="why-a-hurdle-model" class="level3">
<h3 class="anchored" data-anchor-id="why-a-hurdle-model">Why a Hurdle Model?</h3>
<p>Traditional count models (Poisson, negative binomial) underestimate zeros. Our data exhibits:</p>
<ul>
<li><p>Excess zeros: 97.2% of segments have no roadkill</p></li>
<li><p>Overdispersion: Variance (0.12) &gt;&gt; Mean (0.045)</p></li>
</ul>
<p>A <strong>hurdle model</strong> separates two processes:</p>
<ol type="1">
<li><strong>Binary hurdle</strong> (logistic): Does roadkill occur at all?</li>
<li><strong>Count component</strong> (negative binomial): How many events, given occurrence?</li>
</ol>
</section>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification">Model Specification</h3>
<p>A <strong>hurdle model</strong> separates the data-generating process into two parts:</p>
<p><strong>Part 1: Zero hurdle (Binary component)</strong></p>
<p>Models whether any roadkill occurs on a road segment.</p>
<p><span class="math display">\[
\begin{aligned}
Z_i &amp;\sim \text{Binomial}(\pi_i) \\
\text{logit}(\pi_i) &amp;= \alpha_0 + \alpha_1 \log(\text{AADT}_i) + \alpha_2 \text{Minor}_i\\
&amp;\quad + \alpha_4 \text{Speed}_i + \alpha_5 \text{Forest}_i + \alpha_6 \text{Farm}_i \\
&amp;\quad + \alpha_7 \text{Residential}_i + \alpha_8 \text{Park}_i
\end{aligned}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Z_i = 1\)</span> if roadkill occurs, <span class="math inline">\(Z_i = 0\)</span> otherwise</p></li>
<li><p><span class="math inline">\(\pi_i\)</span> is the probability of observing any roadkill on segment <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\text{Minor}_i\)</span> is an indicator for road type (0 or 1; reference level: Major roads (0))</p></li>
</ul>
<p><strong>Part 2: Count component (Positive counts only)</strong></p>
<p>Models the number of roadkill events, conditional on at least one event occurring (<span class="math inline">\(Z_i = 1\)</span>).</p>
<p><span class="math display">\[
\begin{aligned}
Y_i | Z_i = 1 &amp;\sim \text{Negative Binomial}(\mu_i, \theta) \\
\log(\mu_i) &amp;= \beta_0 + \beta_1 \log(\text{AADT}_i) + \beta_2 \text{Minor}_i \\
&amp;\quad + \beta_4 \text{Speed}_i + \beta_5 \text{Forest}_i + \beta_6 \text{Farm}_i \\
&amp;\quad + \beta_7 \text{Residential}_i + \beta_8 \text{Park}_i + \log(\text{Length}_i)
\end{aligned}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> is the count of roadkill events on segment <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(\mu_i\)</span> is the expected count given occurrence - <span class="math inline">\(\theta\)</span> is the dispersion parameter</p></li>
<li><p><span class="math inline">\(\log(\text{Length}_i)\)</span> is an offset controlling for road segment exposure</p></li>
</ul>
<p><strong>Why Negative Binomial?</strong></p>
<p>Our data show overdispersion (Variance/Mean = 2.71), which violates the Poisson assumption that variance equals the mean. The Negative Binomial distribution allows <span class="math inline">\(\text{Var}(Y_i) &gt; \mathbb{E}[Y_i]\)</span>.</p>
<section id="model-validation-simulation-test" class="level4">
<h4 class="anchored" data-anchor-id="model-validation-simulation-test">Model Validation: Simulation Test</h4>
<p>Before applying to real data, we verify the model recovers known parameters from simulated data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x_sim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sim, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># True parameters for hurdle model</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>beta0_zero <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span>   <span class="co"># Zero component models P(Y &gt; 0)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>beta1_zero <span class="ot">&lt;-</span> <span class="fl">0.3</span>    </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>beta0_count <span class="ot">&lt;-</span> <span class="fl">0.5</span>   <span class="co"># Count component models E[Y | Y &gt; 0]</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>beta1_count <span class="ot">&lt;-</span> <span class="fl">0.2</span>   </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">1.5</span>         <span class="co"># Dispersion parameter</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate binary outcomes (does roadkill occur?)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>logit_prob_nonzero <span class="ot">&lt;-</span> beta0_zero <span class="sc">+</span> beta1_zero <span class="sc">*</span> x_sim</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>prob_nonzero <span class="ot">&lt;-</span> <span class="fu">plogis</span>(logit_prob_nonzero)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>z_sim <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_sim, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob_nonzero)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate positive counts for non-zero cases</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>mu_untruncated <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta0_count <span class="sc">+</span> beta1_count <span class="sc">*</span> x_sim)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>y_counts <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all counts (will be zeroed out where z_sim == 0)</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>temp_counts <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(n_sim, <span class="at">mu =</span> mu_untruncated, <span class="at">size =</span> theta)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate at 1 (reject zeros, replace with next draw)</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">any</span>(temp_counts <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> z_sim <span class="sc">==</span> <span class="dv">1</span>)) {</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  need_redraw <span class="ot">&lt;-</span> (temp_counts <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> z_sim <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  temp_counts[need_redraw] <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="fu">sum</span>(need_redraw), </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">mu =</span> mu_untruncated[need_redraw], </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> theta)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>y_sim <span class="ot">&lt;-</span> temp_counts <span class="sc">*</span> z_sim  <span class="co"># Multiply by occurrence (zeros out non-occurrences)</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x_sim, <span class="at">y =</span> y_sim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Simulated data characteristics:</p>
<blockquote class="blockquote">
<ul>
<li>Zero rate: 9%</li>
<li>Mean count (all): 12.864</li>
<li>Mean count (non-zero only): 14.131</li>
</ul>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit hurdle model to simulated data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sim_hurdle <span class="ot">&lt;-</span> <span class="fu">hurdle</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim_data, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract estimated parameters</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>sim_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(sim_hurdle)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="parameter-recovery-check" class="level4">
<h4 class="anchored" data-anchor-id="parameter-recovery-check">Parameter recovery check</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check parameter</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>zero_intercept <span class="ot">&lt;-</span> sim_coefs[<span class="st">"zero_(Intercept)"</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>zero_slope <span class="ot">&lt;-</span> sim_coefs[<span class="st">"zero_x"</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>count_intercept <span class="ot">&lt;-</span> sim_coefs[<span class="st">"count_(Intercept)"</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>count_slope <span class="ot">&lt;-</span> sim_coefs[<span class="st">"count_x"</span>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>recovery_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Zero"</span>, <span class="st">"Zero"</span>, <span class="st">"Count"</span>, <span class="st">"Count"</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Slope"</span>, <span class="st">"Intercept"</span>, <span class="st">"Slope"</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">True Value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(beta0_zero, beta1_zero, beta0_count, beta1_count),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimated =</span> <span class="fu">round</span>(<span class="fu">c</span>(zero_intercept, zero_slope, count_intercept, count_slope), <span class="dv">3</span>),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Difference =</span> <span class="fu">round</span>(<span class="fu">c</span>(zero_intercept, zero_slope, count_intercept, count_slope) <span class="sc">-</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(beta0_zero, beta1_zero, beta0_count, beta1_count), <span class="dv">3</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Recovered =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(Difference) <span class="sc">&lt;</span> <span class="fl">0.2</span>, <span class="st">"✓"</span>, <span class="st">"✗"</span>))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(recovery_table, <span class="at">caption =</span> <span class="st">"Parameter Recovery Check: Simulated Data"</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Parameter Recovery Check: Simulated Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">True Value</th>
<th style="text-align: right;">Estimated</th>
<th style="text-align: right;">Difference</th>
<th style="text-align: left;">Recovered</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Zero</td>
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">-0.342</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zero</td>
<td style="text-align: left;">Slope</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count</td>
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.493</td>
<td style="text-align: right;">-0.007</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count</td>
<td style="text-align: left;">Slope</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: left;">✓</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Conclusion: Model successfully recovers known parameters (differences &lt; 0.2). We can apply it to real data with confidence.</p>
<p>We use our predictions to calculate the standard error</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/sim-visualization-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Takeaway</strong>: The simulation proves our modeling framework works—when we feed the hurdle model data generated from known parameters, it successfully recovers those parameters. This gives us confidence to apply it to real data where the true parameters are unknown.</p>
<hr>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>7. Results</h1>
<section id="fit-model-to-real-data" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-to-real-data">Fit Model to Real Data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model with traffic, road characteristics, and land use</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>hurdle_model <span class="ot">&lt;-</span> <span class="fu">hurdle</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  roadkill_count <span class="sc">~</span> log_AADT <span class="sc">+</span> road_type <span class="sc">+</span> speed_limit <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                   pct_forest <span class="sc">+</span> pct_farmland <span class="sc">+</span> pct_residential <span class="sc">+</span> pct_park <span class="sc">|</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                   log_AADT <span class="sc">+</span> road_type <span class="sc">+</span> speed_limit <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                   pct_forest <span class="sc">+</span> pct_farmland <span class="sc">+</span> pct_residential <span class="sc">+</span> pct_park,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> model_data,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="fu">log</span>(len_km),  <span class="co"># Controls for road length exposure</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> config<span class="sc">$</span>model_distribution,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">zero.dist =</span> config<span class="sc">$</span>model_zero_dist</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="model-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h4>
<blockquote class="blockquote">
<ul>
<li>Log-Likelihood: -3.06601^{4}</li>
<li>AIC: 6.13581^{4}</li>
<li>BIC: 6.15557^{4}</li>
</ul>
</blockquote>
</section>
</section>
<section id="model-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="model-coefficients">Model Coefficients</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Hurdle Model Results</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">Z_value</th>
<th style="text-align: right;">P_value</th>
<th style="text-align: left;">Sig</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">count_(Intercept)</td>
<td style="text-align: right;">-1.7814</td>
<td style="text-align: right;">0.2828</td>
<td style="text-align: right;">-6.30</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_log_AADT</td>
<td style="text-align: right;">0.0284</td>
<td style="text-align: right;">0.0147</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">0.05336</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_road_typeMinor</td>
<td style="text-align: right;">-0.8553</td>
<td style="text-align: right;">0.0907</td>
<td style="text-align: right;">-9.43</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_road_typeOther</td>
<td style="text-align: right;">-1.3791</td>
<td style="text-align: right;">0.4439</td>
<td style="text-align: right;">-3.11</td>
<td style="text-align: right;">0.00189</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_speed_limit</td>
<td style="text-align: right;">0.0083</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;">7.37</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_pct_forest</td>
<td style="text-align: right;">0.0099</td>
<td style="text-align: right;">0.0025</td>
<td style="text-align: right;">4.01</td>
<td style="text-align: right;">0.00006</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_pct_farmland</td>
<td style="text-align: right;">-0.0055</td>
<td style="text-align: right;">0.0023</td>
<td style="text-align: right;">-2.44</td>
<td style="text-align: right;">0.01457</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_pct_residential</td>
<td style="text-align: right;">0.0027</td>
<td style="text-align: right;">0.0028</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.33542</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_pct_park</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0041</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.73733</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_(Intercept)</td>
<td style="text-align: right;">-4.2640</td>
<td style="text-align: right;">0.1144</td>
<td style="text-align: right;">-37.29</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_log_AADT</td>
<td style="text-align: right;">0.0032</td>
<td style="text-align: right;">0.0073</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.66214</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_road_typeMinor</td>
<td style="text-align: right;">-1.2231</td>
<td style="text-align: right;">0.0379</td>
<td style="text-align: right;">-32.24</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_road_typeOther</td>
<td style="text-align: right;">-1.5628</td>
<td style="text-align: right;">0.1124</td>
<td style="text-align: right;">-13.90</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_speed_limit</td>
<td style="text-align: right;">0.0064</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">12.83</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_pct_forest</td>
<td style="text-align: right;">0.0311</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;">28.17</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_pct_farmland</td>
<td style="text-align: right;">0.0214</td>
<td style="text-align: right;">0.0010</td>
<td style="text-align: right;">21.68</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_pct_residential</td>
<td style="text-align: right;">-0.0137</td>
<td style="text-align: right;">0.0012</td>
<td style="text-align: right;">-11.49</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_pct_park</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;">0.0021</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.67786</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation-guide" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-guide">Interpretation guide:</h4>
<ul>
<li><p><strong>Zero component</strong>: Coefficients are log-odds. Positive → increases probability of roadkill occurring</p></li>
<li><p><strong>Count component</strong>: Coefficients are on log scale. Positive → increases expected count given occurrence</p></li>
<li><p><strong>Significance</strong>: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05</p></li>
</ul>
</section>
</section>
<section id="model-fit-to-data" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-to-data">Model Fit to Data</h3>
<p>This visualization shows how well our hurdle model captures the observed roadkill patterns.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Forest effect on occurrence</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary_bin</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> model_data,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pct_forest, <span class="at">y =</span> <span class="fu">as.numeric</span>(roadkill_count <span class="sc">&gt;</span> <span class="dv">0</span>)),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> primary_color,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_forest,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pct_forest, <span class="at">ymin =</span> prob_lower, <span class="at">ymax =</span> prob_upper),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> accent_color</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_forest,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pct_forest, <span class="at">y =</span> prob_nonzero),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> accent_color,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"A. Does Roadkill Occur? (Zero Hurdle)"</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Forest coverage strongly predicts IF roadkill happens"</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"% Forest within 500m"</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of Any Roadkill"</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cohesive</span>()</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Road type occurrence</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>empirical_roadtype <span class="ot">&lt;-</span> model_data <span class="sc">%&gt;%</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(road_type) <span class="sc">%&gt;%</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">empirical_prob =</span> <span class="fu">mean</span>(roadkill_count <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> empirical_roadtype,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> road_type, <span class="at">y =</span> empirical_prob),</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> primary_color,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.7</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_roadtype,</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> road_type, <span class="at">ymin =</span> prob_lower, <span class="at">ymax =</span> prob_upper),</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> accent_color,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_roadtype,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> road_type, <span class="at">y =</span> prob_nonzero),</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> accent_color,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"B. Does Roadkill Occur? (Zero Hurdle)"</span>,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Major roads 7x more likely to have roadkill"</span>,</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Road Type"</span>,</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of Any Roadkill"</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cohesive</span>()</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Forest effect on intensity</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> model_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roadkill_count <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pct_forest, <span class="at">y =</span> roadkill_count <span class="sc">/</span> len_km),</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> primary_color,</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_forest,</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pct_forest, <span class="at">ymin =</span> count_lower, <span class="at">ymax =</span> count_upper),</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> accent_color</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_forest,</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> pct_forest, <span class="at">y =</span> count_given_nonzero),</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> accent_color,</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"C. How Much Roadkill? (Count Component)"</span>,</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Forest has weak effect on intensity (nearly flat line)"</span>,</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"% Forest within 500m"</span>,</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Roadkill Events per km"</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cohesive</span>()</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Road type intensity  </span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> model_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roadkill_count <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> road_type, <span class="at">y =</span> roadkill_count <span class="sc">/</span> len_km),</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> primary_color,</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.alpha =</span> <span class="fl">0.3</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_roadtype,</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> road_type, <span class="at">ymin =</span> count_lower, <span class="at">ymax =</span> count_upper),</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> accent_color,</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> newdata_roadtype,</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> road_type, <span class="at">y =</span> count_given_nonzero),</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> accent_color,</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"D. How Much Roadkill? (Count Component)"</span>,</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Road type also affects intensity, but less dramatically"</span>,</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Road Type"</span>,</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Roadkill Events per km"</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cohesive</span>()</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4) <span class="sc">+</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Hurdle Model: Separating 'IF' from 'HOW MUCH'"</span>,</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Green = observed data, Orange = model predictions with 95% CI. Top row shows OCCURRENCE (zero hurdle). Bottom row shows INTENSITY (count component, conditional on occurrence)."</span>,</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> text_dark),</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> text_mid)</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-fit-separating-occurrence-from-intensity" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-separating-occurrence-from-intensity">Model Fit: Separating Occurrence from Intensity</h3>
<p>The model successfully captures two distinct processes revealed in the data:</p>
<p><strong>Left column (Forest effect):</strong> Panel A shows forest coverage strongly predicts whether roadkill occurs - probability rises from ~2% to ~20% as forest increases from 0% to 100%. However, Panel C shows that once roadkill does occur, forest has minimal effect on intensity (nearly flat trend line). Forest acts as a “gatekeeper” for occurrence but not intensity.</p>
<p><strong>Right column (Road type effect):</strong> Panel B shows Major roads are 7x more likely to experience any roadkill than Minor roads (~7% vs ~1% probability). Panel D shows Major roads also have slightly higher intensity when roadkill does occur, though the difference is less dramatic than for occurrence.</p>
<p><strong>Model performance:</strong> The tight agreement between observed data (green) and predictions (orange with 95% CI) confirms the hurdle model adequately captures these relationships. The distinct patterns between top and bottom rows validate our two-component modeling approach - a single count model would miss this</p>
</section>
<section id="hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h3>
<section id="h1-traffic-volume-effect" class="level4">
<h4 class="anchored" data-anchor-id="h1-traffic-volume-effect">H1: Traffic Volume Effect</h4>
<div class="columns">
<div class="column">
<p><strong>Occurrence component:</strong></p>
<ul>
<li><p>Coefficient: 0.0032, SE: 0.0073, p = 0.66214</p></li>
<li><p>Result: Traffic does not significantly affect roadkill probability</p></li>
</ul>
</div><div class="column">
<p><strong>Intensity component:</strong></p>
<ul>
<li><p>Coefficient: 0.0284, SE: 0.0147, p = 0.05336 .</p></li>
<li><p>Result: Traffic does not significantly affect collision intensity</p></li>
</ul>
</div>
</div>
<div class="columns">
<div class="column">
<p>H1 Status: <strong>NOT SUPPORTED</strong></p>
</div><div class="column">
<p><strong>Effect size:</strong> A 10% increase in traffic volume:</p>
<ul>
<li><p>Changes odds of occurrence by 0%</p></li>
<li><p>Changes expected count by 0.3%</p></li>
</ul>
</div>
</div>
</section>
<section id="h2-land-use-effects" class="level4">
<h4 class="anchored" data-anchor-id="h2-land-use-effects">H2: Land Use Effects</h4>
<div class="columns">
<div class="column">
<section id="h2a-forestpark-habitat" class="level5">
<h5 class="anchored" data-anchor-id="h2a-forestpark-habitat">H2a: Forest/Park habitat</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 6^{-5} ***</p>
<p>Forest coverage significantly affects roadkill patterns.</p>
</section>
</div><div class="column">
<section id="h2b-residential-development" class="level5">
<h5 class="anchored" data-anchor-id="h2b-residential-development">H2b: Residential development</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 0.33542</p>
<p>Residential areas show negative association (as predicted).</p>
</section>
</div><p>H2 Status: <strong>SUPPORTED</strong></p>
</div>
</section>
<section id="h3-road-characteristics" class="level4">
<h4 class="anchored" data-anchor-id="h3-road-characteristics">H3: Road Characteristics</h4>
<div class="columns">
<div class="column">
<section id="h3a-minor-roads-vs-major-baseline" class="level5">
<h5 class="anchored" data-anchor-id="h3a-minor-roads-vs-major-baseline">H3a: Minor roads (vs Major baseline)</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 0 ***</p>
<p>Minor roads have lower roadkill rates than major roads.</p>
</section>
</div><div class="column">
<section id="h3b-speed-limit" class="level5">
<h5 class="anchored" data-anchor-id="h3b-speed-limit">H3b: Speed limit</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 0 ***</p>
<p>Speed limit significantly affect s collision risk.</p>
</section>
</div><p>H3 Status: <strong>SUPPORTED</strong></p>
</div>
<hr>
</section>
</section>
</section>
<section id="discussion" class="level1">
<h1>8. Discussion</h1>
<section id="summary-of-findings" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-findings">Summary of Findings</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Hypothesis Test Results (+ positive effect, − negative effect, NS not significant; baseline: Major roads)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Hypothesis</th>
<th style="text-align: left;">Occurrence</th>
<th style="text-align: left;">Intensity</th>
<th style="text-align: left;">Support</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H1: Traffic</td>
<td style="text-align: left;">NS</td>
<td style="text-align: left;">NS</td>
<td style="text-align: left;">✗</td>
</tr>
<tr class="even">
<td style="text-align: left;">H2a: Forest</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H2b: Residential</td>
<td style="text-align: left;">−</td>
<td style="text-align: left;">NS</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="even">
<td style="text-align: left;">H3a: Minor roads</td>
<td style="text-align: left;">−</td>
<td style="text-align: left;">−</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H3b: Speed</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">✓</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="policy-implications" class="level3">
<h3 class="anchored" data-anchor-id="policy-implications">Policy Implications</h3>
<p>Our findings suggest several evidence-based mitigation strategies:</p>
<ol type="1">
<li><p><strong>Traffic management</strong>: Roads with AADT &gt; 2,853 vehicles/day (75th percentile) near natural habitats are high-priority for wildlife warning systems</p></li>
<li><p><strong>Targeted interventions</strong>: Focus mitigation efforts (wildlife crossings, fencing) on:</p></li>
</ol>
<ul>
<li><p>High-traffic corridors adjacent to forests/parks</p></li>
<li><p>Major highways with speed limits ≥80 km/h</p></li>
<li><p>Areas where predicted collision probability exceeds threshold</p></li>
</ul>
<ol start="3" type="1">
<li><strong>Land use planning</strong>: Consider roadkill risk when approving development near wildlife habitat</li>
</ol>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ol type="1">
<li><p><strong>Spatial coverage.</strong> The analysis includes only roads near traffic counters (about 75% of the network). Low-traffic and rural roads may be underrepresented.</p></li>
<li><p><strong>Species grouping.</strong> All species are combined into one outcome. This hides differences in behavior and risk between species.</p></li>
<li><p><strong>Timing differences across datasets.</strong> Road data are from 2024, traffic data from 2019, and crash records from 2017–2019. Seasonal and daily patterns are not modeled, and these timing differences may add error.</p></li>
<li><p><strong>Missing variables.</strong> The model does not include direct data on animal population size, movement, road features (such as fencing and lighting), or driver behavior. These factors could affect collision risk and may influence the results.</p></li>
<li><p><strong>Reporting bias.</strong> Not all collisions are reported, and reporting likely differs by location. Rural areas in particular may appear safer simply because fewer events are recorded.</p></li>
<li><p><strong>Spatial clustering.</strong> Collisions tend to cluster in certain areas, but this spatial pattern is not explicitly modeled. This may lead to uncertainty being understated.</p></li>
<li><p><strong>Interpretation.</strong> Results show associations, not cause-and-effect. Land use is used as a stand-in for animal presence, and traffic estimates are imperfect.</p></li>
</ol>
<section id="conclusions" class="level4">
<h4 class="anchored" data-anchor-id="conclusions">Conclusions</h4>
<p>This analysis demonstrates how hurdle models handle zero-inflated ecological count data by separately modeling occurrence and intensity processes. We identified traffic volume, land use composition, and road characteristics as key predictors of wildlife-vehicle collisions on Danish roads.</p>
<p>Key contributions:</p>
<ul>
<li><p>Methodological framework for zero-inflated spatial count data</p></li>
<li><p>Quantified effects of infrastructure and landscape on roadkill risk</p></li>
<li><p>Policy-relevant findings for targeted mitigation</p></li>
</ul>
<p>The hurdle model approach extends beyond roadkill to any ecological phenomenon with excess zeros: rare species observations, disease outbreaks, extreme weather events, or pollution violations.</p>
<hr>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-vejdirektoratet2019" class="csl-entry" role="listitem">
Danish Road Directorate. 2017--2019. <span>“Traffic Counts – Key Figures (MASTRA).”</span> <a href="https://www.opendata.dk/vejdirektoratet/taellinger-nogletal-mastra" class="uri">https://www.opendata.dk/vejdirektoratet/taellinger-nogletal-mastra</a>.
</div>
<div id="ref-grilo2025" class="csl-entry" role="listitem">
Grilo, Clara, Tomé Neves, Jennifer Bates, Aliza le Roux, Pablo Medrano-Vizcaíno, Mattia Quaranta, Inês Silva, et al. 2025. <span>“Global Roadkill Data: A Dataset on Terrestrial Vertebrate Mortality Caused by Collision with Vehicles.”</span> figshare. <a href="https://doi.org/10.6084/M9.FIGSHARE.25714233">https://doi.org/10.6084/M9.FIGSHARE.25714233</a>.
</div>
<div id="ref-osm2024" class="csl-entry" role="listitem">
OpenStreetMap contributors. 2024. <span>“Planet Dump Retrieved from Https://Planet.openstreetmap.org.”</span> <a href="https://www.openstreetmap.org" class="uri">https://www.openstreetmap.org</a>.
</div>
</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{miller2025,
  author = {Miller, Emily and Miller, Emily},
  title = {Traffic, {Land} {Use,} and {Wildlife-Vehicle} {Collisions} in
    {Denmark}},
  date = {2025-11-29},
  url = {https://rellimylime.github.io/posts/eds222-final/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-miller2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Miller, Emily, and Emily Miller. 2025. <span>“Traffic, Land Use, and
Wildlife-Vehicle Collisions in Denmark.”</span> November 29, 2025. <a href="https://rellimylime.github.io/posts/eds222-final/">https://rellimylime.github.io/posts/eds222-final/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>