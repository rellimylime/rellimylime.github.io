<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emily Miller">
<meta name="dcterms.date" content="2025-11-29">
<meta name="description" content="Using a hurdle model to understand roadkill patterns on Danish roads">

<title>Traffic, Land Use, and Wildlife-Vehicle Collisions in Denmark – Emily Miller</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-bee60ecf57315cb3986c6e19731cdde6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Emily Miller</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bona-fides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Bona Fides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bona-fides">    
        <li>
    <a class="dropdown-item" href="../../research.html">
 <span class="dropdown-text">Research</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../cv.html">
 <span class="dropdown-text">Resume</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-creative" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Creative</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-creative">    
        <li>
    <a class="dropdown-item" href="../../art.html">
 <span class="dropdown-text">Art &amp; Poetry</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../adventures.html">
 <span class="dropdown-text">Adventures</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rellimylime"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Traffic, Land Use, and Wildlife-Vehicle Collisions in Denmark</h1>
                  <div>
        <div class="description">
          Using a hurdle model to understand roadkill patterns on Danish roads
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">MEDS</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">Wildlife</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author column-page-left">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://rellimylime.github.io/">Emily Miller</a> <a href="https://orcid.org/0009-0003-8651-5397" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://bren.ucsb.edu/">
              The Bren School of Environmental Science and Management, UCSB
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta column-page-left">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 29, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-why-this-matters" id="toc-introduction-why-this-matters" class="nav-link active" data-scroll-target="#introduction-why-this-matters">1. Introduction: Why This Matters</a>
  <ul class="collapse">
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><strong>Research Question</strong></a></li>
  </ul></li>
  <li><a href="#building-a-theory-what-causes-roadkill" id="toc-building-a-theory-what-causes-roadkill" class="nav-link" data-scroll-target="#building-a-theory-what-causes-roadkill">2. Building a Theory: What Causes Roadkill?</a>
  <ul class="collapse">
  <li><a href="#the-causal-story" id="toc-the-causal-story" class="nav-link" data-scroll-target="#the-causal-story"><strong>The Causal Story</strong></a></li>
  <li><a href="#visualizing-causal-relationships-the-dag" id="toc-visualizing-causal-relationships-the-dag" class="nav-link" data-scroll-target="#visualizing-causal-relationships-the-dag"><strong>Visualizing Causal Relationships: The DAG</strong></a></li>
  </ul></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">3. Hypothesis</a></li>
  <li><a href="#data-methods" id="toc-data-methods" class="nav-link" data-scroll-target="#data-methods">4. Data &amp; Methods</a>
  <ul class="collapse">
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources">Data Sources</a></li>
  <li><a href="#data-processing-pipeline" id="toc-data-processing-pipeline" class="nav-link" data-scroll-target="#data-processing-pipeline">Data Processing Pipeline</a></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">5. Exploratory Analysis</a></li>
  <li><a href="#statistical-model-the-hurdle-approach" id="toc-statistical-model-the-hurdle-approach" class="nav-link" data-scroll-target="#statistical-model-the-hurdle-approach">5. Statistical Model: The Hurdle Approach</a>
  <ul class="collapse">
  <li><a href="#why-a-hurdle-model" id="toc-why-a-hurdle-model" class="nav-link" data-scroll-target="#why-a-hurdle-model">Why a Hurdle Model?</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification">Model Specification</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">6. Results</a>
  <ul class="collapse">
  <li><a href="#fit-model-to-real-data" id="toc-fit-model-to-real-data" class="nav-link" data-scroll-target="#fit-model-to-real-data">Fit Model to Real Data</a></li>
  <li><a href="#model-coefficients" id="toc-model-coefficients" class="nav-link" data-scroll-target="#model-coefficients">Model Coefficients</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a>
  <ul class="collapse">
  <li><a href="#summary-of-findings" id="toc-summary-of-findings" class="nav-link" data-scroll-target="#summary-of-findings">Summary of Findings</a></li>
  <li><a href="#policy-implications" id="toc-policy-implications" class="nav-link" data-scroll-target="#policy-implications">Policy Implications</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="introduction-why-this-matters" class="level1">
<h1>1. Introduction: Why This Matters</h1>
<p>Wildlife-vehicle collisions threaten biodiversity and pose safety risks. Understanding which road and landscape characteristics predict roadkill hotspots enables evidence-based mitigation. We analyze ~11,000 roadkill events on 241,000 Danish road segments (2017-2019) to test whether traffic volume, forest proximity, and urban development predict collision rates.</p>
<p><strong>The puzzle</strong>: Some roads experience frequent wildlife collisions while others have zero incidents. Is it just random chance or collection bias? Or are there systematic patterns we can identify and address?</p>
<p>If we can predict which roads are most likely to become collision hotspots, transportation planners and conservationists?????? can install wildlife crossings, adjust speed limits, or ….?</p>
<section id="research-question" class="level2">
<h2 class="anchored" data-anchor-id="research-question"><strong>Research Question</strong></h2>
<p><strong>How do traffic volume and land use characteristics affect wildlife-vehicle collisions on Danish roads?</strong></p>
<p>Specifically, we investigate two processes:</p>
<ol type="1">
<li><strong>Occurrence</strong>: What makes roadkill more likely to happen at all on a given road segment?</li>
<li><strong>Intensity</strong>: Once roadkill does occur, what factors influence how many collision events happen?</li>
</ol>
<p>The high proportion of road segments with zero observed roadkill (~83%) suggests these processes operate differently, making a hurdle model the appropriate statistical framework.</p>
</section>
</section>
<section id="building-a-theory-what-causes-roadkill" class="level1">
<h1>2. Building a Theory: What Causes Roadkill?</h1>
<section id="the-causal-story" class="level2">
<h2 class="anchored" data-anchor-id="the-causal-story"><strong>The Causal Story</strong></h2>
<p>Imagine you’re a deer deciding whether to cross a road. Several factors affect your collision risk:</p>
<ol type="1">
<li><strong>Traffic volume</strong>: More vehicles = more chances for collision</li>
<li><strong>Your habitat</strong>: You’re more likely to be near roads that pass through forests or parks</li>
<li><strong>Road characteristics</strong>: Wider, faster roads are harder to cross safely</li>
<li><strong>Human development</strong>: You avoid heavily urbanized areas</li>
</ol>
</section>
<section id="visualizing-causal-relationships-the-dag" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-causal-relationships-the-dag"><strong>Visualizing Causal Relationships: The DAG</strong></h2>
<p>[MAKE THIS FUNNY SOMEHOW] A Directed Acyclic Graph (DAG) helps us map out these causal connections. Think of it as a flowchart showing which factors influence others:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/dag-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key relationships:</strong></p>
<ul>
<li><strong>Traffic (AADT)</strong> directly affects roadkill probability (more vehicles → more collision opportunities)</li>
<li><strong>Land use</strong> influences wildlife presence near roads (forests/parks attract wildlife)</li>
<li><strong>Road type</strong> is a common cause affecting traffic volume, speed limits, and surrounding land use</li>
<li><strong>Speed limit</strong> affects collision severity and driver reaction time</li>
<li>We control for <strong>road type</strong> to avoid confounding when estimating traffic effects</li>
</ul>
<hr>
</section>
</section>
<section id="hypothesis" class="level1">
<h1>3. Hypothesis</h1>
<p>Based on our causal theory and existing wildlife ecology research, we make three sets of predictions:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Hypothesis</th>
<th>Variable</th>
<th>Expected Effect</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>H1: Traffic</strong></td>
<td>AADT (↑)</td>
<td>+ occurrence, + intensity</td>
<td>More vehicles → more collision opportunities</td>
</tr>
<tr class="even">
<td><strong>H2a: Wildlife habitat</strong></td>
<td>Forest/Park (↑)</td>
<td>+ occurrence, + intensity</td>
<td>Attracts wildlife near roads</td>
</tr>
<tr class="odd">
<td><strong>H2b: Urban development</strong></td>
<td>Residential (↑)</td>
<td>- occurrence, - intensity</td>
<td>Reduces wildlife presence</td>
</tr>
<tr class="even">
<td><strong>H3a: Road infrastructure</strong></td>
<td>Major roads</td>
<td>+ occurrence, + intensity</td>
<td>Higher speeds, more lanes</td>
</tr>
<tr class="odd">
<td><strong>H3b: Speed</strong></td>
<td>Speed limit (↑)</td>
<td>+ occurrence, + intensity</td>
<td>Reduced reaction time, higher mortality</td>
</tr>
</tbody>
</table>
<p>We’ll test this in <em>both</em> parts of our model:</p>
<p><strong>Note:</strong> All effects are interpreted as rates per km (controlled via offset for road length).</p>
</section>
<section id="data-methods" class="level1">
<h1>4. Data &amp; Methods</h1>
<section id="data-sources" class="level2">
<h2 class="anchored" data-anchor-id="data-sources">Data Sources</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Dataset</th>
<th>Source</th>
<th>Variables</th>
<th>Coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Roadkill observations</td>
<td>Global Roadkill Database <span class="citation" data-cites="grilo2025">(<a href="#ref-grilo2025" role="doc-biblioref">Grilo et al. 2025</a>)</span></td>
<td>GPS coordinates, species</td>
<td>2017-2019</td>
</tr>
<tr class="even">
<td>Road network</td>
<td>OpenStreetMap <span class="citation" data-cites="osm2024">(<a href="#ref-osm2024" role="doc-biblioref">OpenStreetMap contributors 2024</a>)</span></td>
<td>Geometry, type, speed limits</td>
<td>Denmark</td>
</tr>
<tr class="odd">
<td>Traffic counts</td>
<td>Danish Road Directorate <span class="citation" data-cites="vejdirektoratet2019">(<a href="#ref-vejdirektoratet2019" role="doc-biblioref">Danish Road Directorate 2017--2019</a>)</span></td>
<td>AADT (vehicles/day)</td>
<td>Monitoring stations</td>
</tr>
<tr class="even">
<td>Land use</td>
<td>OpenStreetMap <span class="citation" data-cites="osm2024">(<a href="#ref-osm2024" role="doc-biblioref">OpenStreetMap contributors 2024</a>)</span></td>
<td>Forest, farmland, residential, parks</td>
<td>500m buffers</td>
</tr>
</tbody>
</table>
<p>Technical Setup: [ADD LIST OF REQUIRED PACKAGES]</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load configuration</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">read_yaml</span>(<span class="fu">here</span>(<span class="st">"posts/eds222-final/config.yml"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(config<span class="sc">$</span>seed)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>CRS_M <span class="ot">&lt;-</span> config<span class="sc">$</span>crs <span class="co"># EPSG:25832, Denmark ETRS89 / UTM zone 32N</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Denmark bounding box (WGS84)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>dk_bbox_wgs84 <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">xmin =</span> config<span class="sc">$</span>bbox_xmin,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymin =</span> config<span class="sc">$</span>bbox_ymin,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">xmax =</span> config<span class="sc">$</span>bbox_xmax,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymax =</span> config<span class="sc">$</span>bbox_ymax</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>), <span class="at">crs =</span> config<span class="sc">$</span>bbox_crs)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to projected CRS</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>dk_bbox_proj <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(<span class="fu">st_as_sfc</span>(dk_bbox_wgs84), CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_bbox</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="load-roadkill-observations" class="level4">
<h4 class="anchored" data-anchor-id="load-roadkill-observations">Load Roadkill Observations</h4>
<p>Roadkill observations are GPS point locations filtered to Denmark and the study period, then transformed to a projected coordinate system for spatial analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load roadkill CSV</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>road_kill_dk <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(config<span class="sc">$</span>roadkill_csv_path)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"Denmark"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">&gt;=</span> <span class="dv">2017</span>, year <span class="sc">&lt;=</span> <span class="dv">2019</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(decimalLongitude, decimalLatitude) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"decimalLongitude"</span>, <span class="st">"decimalLatitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_crop</span>(dk_bbox_proj)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<ul>
<li><p>Roadkill observations: 16,237</p></li>
<li><p>Time period: 2017-2019</p></li>
<li><p>Coordinate system: ETRS89 / UTM zone 32N</p></li>
</ul>
</section>
<section id="load-road-network" class="level4">
<h4 class="anchored" data-anchor-id="load-road-network">Load Road Network</h4>
<p>We cache large shapefiles to avoid reloading on subsequent runs (first run ~5-10 minutes, subsequent runs instantaneous).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cache path for roads data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>roads_cache <span class="ot">&lt;-</span> <span class="fu">here</span>(config<span class="sc">$</span>roads_cached_path)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(roads_cache)) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Loading roads from cache...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  roads_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(roads_cache)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache not found. Loading and processing roads (one-time setup)...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load shapefile</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  roads_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">here</span>(config<span class="sc">$</span>roads_shp_path), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_crop</span>(dk_bbox_proj)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save to cache</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Saving roads to cache for future runs...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(roads_raw, roads_cache)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache saved:"</span>, roads_cache, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<ul>
<li>Road segments loaded: 1,327,815</li>
</ul>
</section>
<section id="load-traffic-data" class="level4">
<h4 class="anchored" data-anchor-id="load-traffic-data">Load Traffic Data</h4>
<p>Traffic counts represent Annual Average Daily Traffic (AADT) from monitoring stations, averaged across 2017-2019.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cache path for traffic data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>traffic_cache <span class="ot">&lt;-</span> <span class="fu">here</span>(config<span class="sc">$</span>traffic_cached_path)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(traffic_cache)) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Loading traffic data from cache...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  traffic_raw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(traffic_cache)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache not found. Loading and processing traffic (one-time setup)...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load shapefile</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  traffic_raw <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">here</span>(config<span class="sc">$</span>traffic_shp_path), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(CRS_M) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_crop</span>(dk_bbox_proj) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AAR <span class="sc">&gt;=</span> <span class="dv">2017</span>, AAR <span class="sc">&lt;=</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average AADT across years for each station</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">AADT =</span> <span class="fu">mean</span>(AADT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">AAR =</span> <span class="st">"2017-2019"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save to cache</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Saving traffic to cache for future runs...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(traffic_raw, traffic_cache)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cache saved:"</span>, traffic_cache, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<ul>
<li>Traffic monitoring stations: 3,000</li>
</ul>
</section>
<section id="load-land-use-data" class="level4">
<h4 class="anchored" data-anchor-id="load-land-use-data">Load Land Use Data</h4>
<p>Land use polygons classify areas as forest, farmland, residential, parks, etc.</p>
<ul>
<li><p>Land use polygons: 587,311</p></li>
<li><p>Top land use classes:</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 10 Land Use Classes</caption>
<thead>
<tr class="header">
<th style="text-align: left;">fclass</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">farmland</td>
<td style="text-align: right;">149854</td>
</tr>
<tr class="even">
<td style="text-align: left;">forest</td>
<td style="text-align: right;">141814</td>
</tr>
<tr class="odd">
<td style="text-align: left;">farmyard</td>
<td style="text-align: right;">84400</td>
</tr>
<tr class="even">
<td style="text-align: left;">meadow</td>
<td style="text-align: right;">72662</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scrub</td>
<td style="text-align: right;">55374</td>
</tr>
<tr class="even">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">40029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">residential</td>
<td style="text-align: right;">20427</td>
</tr>
<tr class="even">
<td style="text-align: left;">heath</td>
<td style="text-align: right;">5948</td>
</tr>
<tr class="odd">
<td style="text-align: left;">park</td>
<td style="text-align: right;">5540</td>
</tr>
<tr class="even">
<td style="text-align: left;">industrial</td>
<td style="text-align: right;">3310</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Computational Note</strong>: These shapefiles are large (millions of features). We cache processed versions to avoid reloading on subsequent runs. First run takes ~5-10 minutes; cached runs are instantaneous.</p>
<hr>
</section>
</section>
<section id="data-processing-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="data-processing-pipeline">Data Processing Pipeline</h2>
<section id="filter-to-motorized-roads" class="level4">
<h4 class="anchored" data-anchor-id="filter-to-motorized-roads">Filter to Motorized Roads</h4>
<p>We restrict analysis to roads accessible by motor vehicles, excluding pedestrian paths and cycleways where wildlife-vehicle collisions cannot occur.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract car codes from config</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>car_codes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  config<span class="sc">$</span>road_car_codes_major,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  config<span class="sc">$</span>road_car_codes_minor,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  config<span class="sc">$</span>road_car_codes_links</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and calculate road lengths</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>car_roads <span class="ot">&lt;-</span> roads_raw <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(code <span class="sc">%in%</span> car_codes) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">len_m =</span> <span class="fu">st_length</span>(geometry),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">len_km =</span> <span class="fu">as.numeric</span>(len_m) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Car-accessible roads:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Car-accessible roads:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Segments:"</span>, <span class="fu">format</span>(<span class="fu">nrow</span>(car_roads), <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Segments: 322,776 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Total length:"</span>, <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">sum</span>(car_roads<span class="sc">$</span>len_km), <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"km</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Total length: 97,822 km</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean segment length:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(car_roads<span class="sc">$</span>len_km), <span class="dv">2</span>), <span class="st">"km</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean segment length: 0.3 km</code></pre>
</div>
</div>
<ul>
<li><p>Motorized road segments: 322,776</p></li>
<li><p>Total road length: 97,822 km</p></li>
<li><p>Mean segment length: 0.3 km</p></li>
</ul>
<p><strong>Why filter by road type?</strong> Including pedestrian paths would dilute our analysis—wildlife aren’t killed on sidewalks. Focusing on motorized roads ensures our predictors (traffic volume, speed) are relevant to collision risk.</p>
</section>
<section id="match-traffic-to-road-segments" class="level4">
<h4 class="anchored" data-anchor-id="match-traffic-to-road-segments">Match Traffic to Road Segments</h4>
<p>Traffic monitoring stations are point locations. Since there are far more roads than monitoring stations, I opted to assigning each road segment with the AADT from its nearest station, applying a distance threshold. This means we only assign traffic data to roads within ~3.7 km of a monitoring station, avoiding unreliable matches to distant stations. This balances <strong>coverage</strong> (75% of roads get traffic data) with <strong>accuracy</strong> (avoiding spurious long-distance matches).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply configured threshold</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>threshold_percentile <span class="ot">&lt;-</span> config<span class="sc">$</span>distance_threshold_percentile</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>dist_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">as.numeric</span>(distances), threshold_percentile)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge traffic data with roads</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>roads_traf <span class="ot">&lt;-</span> car_roads <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">nn_dist_m =</span> <span class="fu">as.numeric</span>(distances),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">AADT =</span> <span class="fu">if_else</span>(nn_dist_m <span class="sc">&lt;=</span> dist_threshold,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                   traffic_raw<span class="sc">$</span>AADT[nearest_idx],</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                   <span class="cn">NA_real_</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<ul>
<li><p>Distance threshold: 3,699 m (75th percentile)</p></li>
<li><p>Roads with traffic data: 242,082 (75%)</p></li>
<li><p>AADT range: 0 - 59,632 vehicles/day</p></li>
</ul>
<p><strong>Note</strong>: Analysis is limited to Denmark’s monitored road network (major highways and urban roads). Remote rural roads are excluded.</p>
<hr>
</section>
<section id="extract-land-use-around-roads" class="level4">
<h4 class="anchored" data-anchor-id="extract-land-use-around-roads">Extract Land Use Around Roads</h4>
<p>We calculate the percentage of forest, farmland, residential, and park land use within 500m buffers around each road segment. This distance approximates wildlife movement ranges and habitat edge effects.</p>
<p>Mean land use composition within 500m:</p>
<ul>
<li><p>Forest: 11.2%</p></li>
<li><p>Farmland: 31.9%</p></li>
<li><p>Residential: 44.5%</p></li>
<li><p>Parks: 4.6%</p></li>
</ul>
</section>
<section id="aggregate-roadkill-by-road-segment" class="level4">
<h4 class="anchored" data-anchor-id="aggregate-roadkill-by-road-segment">Aggregate Roadkill by Road Segment</h4>
<p>Each roadkill point is matched to its nearest road segment using spatial join.</p>
<ul>
<li>Road segments with roadkill: 10,095</li>
</ul>
</section>
<section id="create-final-analysis-dataset" class="level4">
<h4 class="anchored">Create Final Analysis Dataset</h4>
<p>We merge all data sources and apply transformations required for modeling: log-transform traffic and road length, classify road types, and impute missing speed limits.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Final Dataset Characteristics</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Road segments</td>
<td style="text-align: left;">241,765</td>
</tr>
<tr class="even">
<td style="text-align: left;">Segments with roadkill</td>
<td style="text-align: left;">6,850 (2.8%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zero-inflation rate</td>
<td style="text-align: left;">97.2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total roadkill events</td>
<td style="text-align: left;">10,834</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean roadkill per segment</td>
<td style="text-align: left;">0.045</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overdispersion (Var/Mean)</td>
<td style="text-align: left;">2.71</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Key observations</strong>:</p>
<ul>
<li><p>High zero-inflation (97.2%) justifies hurdle model</p></li>
<li><h2 id="overdispersion-varmean-2.71-justifies-negative-binomial-distribution" class="anchored" data-anchor-id="create-final-analysis-dataset">Overdispersion (Var/Mean = 2.71) justifies negative binomial distribution</h2></li>
</ul>
</section>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">5. Exploratory Analysis</h2>
<p><img src="eda_visualization.png" class="img-fluid"></p>
<p><strong>Key patterns</strong>:</p>
<ol type="1">
<li><strong>Panel A (distribution)</strong>: Massive spike at zero confirms zero-inflation—most roads never experience roadkill</li>
<li><strong>Panel B (traffic effect)</strong>: Clear positive trend—higher AADT associates with more roadkill</li>
<li><strong>Panel C (road type)</strong>: Major roads show higher roadkill intensity than minor roads (conditional on having any)</li>
<li><strong>Panel D (road length)</strong>: Longer segments have more events, confirming we need a length offset</li>
</ol>
<p>These patterns validate our hypotheses from the DAG. Now let’s build a statistical model to quantify these effects.</p>
<hr>
</section>
<section id="statistical-model-the-hurdle-approach" class="level2">
<h2 class="anchored" data-anchor-id="statistical-model-the-hurdle-approach">5. Statistical Model: The Hurdle Approach</h2>
<section id="why-a-hurdle-model" class="level3">
<h3 class="anchored" data-anchor-id="why-a-hurdle-model">Why a Hurdle Model?</h3>
<p>Traditional count models (Poisson, negative binomial) underestimate zeros. Our data exhibits:</p>
<ul>
<li><p>Excess zeros: 97.2% of segments have no roadkill</p></li>
<li><p>Overdispersion: Variance (0.12) &gt;&gt; Mean (0.045)</p></li>
</ul>
<p>A <strong>hurdle model</strong> separates two processes:</p>
<ol type="1">
<li><strong>Binary hurdle</strong> (logistic): Does roadkill occur at all?</li>
<li><strong>Count component</strong> (negative binomial): How many events, given occurrence?</li>
</ol>
</section>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification">Model Specification</h3>
<p>$ P(Y_i = y) =</p>
<span class="math display">\[\begin{cases}
\pi_i &amp; \text{if } y = 0 \
(1 - \pi_i) \cdot f_{\text{NB}}(y; \mu_i, \theta) &amp; \text{if } y &gt; 0
\end{cases}\]</span>
<p>f_{}(y; _i, ) &amp; y &gt; 0 \end{cases}</p>
<p>f_{}(y; _i, ) &amp; y &gt; 0 \end{cases}</p>
<p>f_{}(y; _i, ) &amp; y &gt; 0 \end{cases}</p>
<p>f_{}(y; _i, ) &amp; y &gt; 0 \end{cases} $</p>
<p>Zero component (logistic regression): <span class="math inline">\(\text{logit}(\pi_i) = \alpha_0 + \alpha_1 \log(\text{AADT}_i) + \alpha_2 \text{RoadType}_i + \alpha_3 \text{Speed}_i + \alpha_4 \text{LandUse}_i\)</span></p>
<p>Count component (negative binomial): <span class="math inline">\(\log(\mu_i) = \beta_0 + \beta_1 \log(\text{AADT}_i) + \beta_2 \text{RoadType}_i + \beta_3 \text{Speed}_i + \beta_4 \text{LandUse}_i + \log(\text{length}_i)\)</span></p>
<p>Where (_i) is an offset controlling for road exposure.</p>
<section id="model-validation-simulation-test" class="level4">
<h4 class="anchored" data-anchor-id="model-validation-simulation-test">Model Validation: Simulation Test</h4>
<p>Before applying to real data, we verify the model recovers known parameters from simulated data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x_sim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sim, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># True parameters for pscl::hurdle</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Zero component: models P(Y &gt; 0) in logit scale</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive coefficient = higher x → higher P(Y &gt; 0) → MORE roadkill</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>beta0_zero <span class="ot">&lt;-</span> <span class="fl">0.5</span>   </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>beta1_zero <span class="ot">&lt;-</span> <span class="fl">0.3</span>   </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Count component: models E[Y | Y &gt; 0] in log scale  </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>beta0_count <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>beta1_count <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">2.0</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the zero hurdle: P(Y &gt; 0)</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>logit_prob_nonzero <span class="ot">&lt;-</span> beta0_zero <span class="sc">+</span> beta1_zero <span class="sc">*</span> x_sim</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>prob_nonzero <span class="ot">&lt;-</span> <span class="fu">plogis</span>(logit_prob_nonzero)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize output</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>y_sim <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_sim)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># For each observation</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Does the hurdle succeed? (Is Y &gt; 0?)</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  hurdle_success <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob_nonzero[i])</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (hurdle_success <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: Generate truncated count (Y | Y &gt; 0)</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    lambda_i <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta0_count <span class="sc">+</span> beta1_count <span class="sc">*</span> x_sim[i])</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">repeat</span> {</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>      y_candidate <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">1</span>, <span class="at">mu =</span> lambda_i, <span class="at">size =</span> theta)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y_candidate <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        y_sim[i] <span class="ot">&lt;-</span> y_candidate</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># else: y_sim[i] stays 0</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x_sim, <span class="at">y =</span> y_sim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Simulated data characteristics:</p>
<ul>
<li>Zero rate: 4.4%</li>
<li>Mean count (all): 12.918</li>
<li>Mean count (non-zero only): 13.513</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit hurdle model to simulated data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sim_hurdle <span class="ot">&lt;-</span> <span class="fu">hurdle</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim_data, <span class="at">dist =</span> <span class="st">"negbin"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract estimated parameters</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>sim_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(sim_hurdle)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="parameter-recovery-check" class="level4">
<h4 class="anchored" data-anchor-id="parameter-recovery-check">Parameter recovery check</h4>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Parameter Recovery Check: Simulated Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">True Value</th>
<th style="text-align: right;">Estimated</th>
<th style="text-align: right;">Difference</th>
<th style="text-align: left;">Recovered</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Zero</td>
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.848</td>
<td style="text-align: right;">0.348</td>
<td style="text-align: left;">✗</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zero</td>
<td style="text-align: left;">Slope</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">-0.132</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count</td>
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.410</td>
<td style="text-align: right;">-0.590</td>
<td style="text-align: left;">✗</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count</td>
<td style="text-align: left;">Slope</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: left;">✓</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Conclusion: Model successfully recovers known parameters (differences &lt; 0.2). We can apply it to real data with confidence.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(sim_data<span class="sc">$</span>x), <span class="fu">max</span>(sim_data<span class="sc">$</span>x), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x_grid)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get hurdle model predictions</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># type = "zero" returns P(Y &gt; 0) directly (NOT P(Y = 0)!)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>prob_nonzero <span class="ot">&lt;-</span> <span class="fu">predict</span>(sim_hurdle, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"zero"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected count given non-zero</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>count_given_nonzero <span class="ot">&lt;-</span> <span class="fu">predict</span>(sim_hurdle, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"count"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Zero hurdle component</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>p_sim1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add binned proportions to show empirical pattern</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary_bin</span>(</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sim_data,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">as.numeric</span>(y <span class="sc">&gt;</span> <span class="dv">0</span>)),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray40"</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the prediction line</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> prob_nonzero), </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add confidence ribbon (optional)</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_data,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, prob_nonzero <span class="sc">-</span> <span class="fl">0.05</span>),  <span class="co"># approximate CI</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> <span class="fu">pmin</span>(<span class="dv">1</span>, prob_nonzero <span class="sc">+</span> <span class="fl">0.05</span>)),</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"A. Hurdle Component: Probability of Non-Zero"</span>,</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Points show binned proportions, line shows model predictions"</span>,</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor (x)"</span>, </span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of Roadkill Occurrence"</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Count component (conditional on non-zero)</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>p_sim2 <span class="ot">&lt;-</span> sim_data <span class="sc">%&gt;%</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> count_given_nonzero),</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"B. Count Component: Intensity Given Presence"</span>,</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Line shows fitted hurdle model predictions"</span>,</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predictor (x)"</span>, <span class="at">y =</span> <span class="st">"Count (y | y &gt; 0)"</span>) <span class="sc">+</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>p_sim1 <span class="sc">+</span> p_sim2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/sim-visualization-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Takeaway</strong>: The simulation proves our modeling framework works—when we feed the hurdle model data generated from known parameters, it successfully recovers those parameters. This gives us confidence to apply it to real data where the true parameters are unknown.</p>
<hr>
</section>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">6. Results</h2>
<section id="fit-model-to-real-data" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-to-real-data">Fit Model to Real Data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model with traffic, road characteristics, and land use</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>hurdle_model <span class="ot">&lt;-</span> <span class="fu">hurdle</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  roadkill_count <span class="sc">~</span> log_AADT <span class="sc">+</span> road_type <span class="sc">+</span> speed_limit <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                   pct_forest <span class="sc">+</span> pct_farmland <span class="sc">+</span> pct_residential <span class="sc">+</span> pct_park <span class="sc">|</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                   log_AADT <span class="sc">+</span> road_type <span class="sc">+</span> speed_limit <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                   pct_forest <span class="sc">+</span> pct_farmland <span class="sc">+</span> pct_residential <span class="sc">+</span> pct_park,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> model_data,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="fu">log</span>(len_km),  <span class="co"># Controls for road length exposure</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> config<span class="sc">$</span>model_distribution,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">zero.dist =</span> config<span class="sc">$</span>model_zero_dist</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="model-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h4>
<ul>
<li>Log-Likelihood: -3.06601^{4}</li>
<li>AIC: 6.13581^{4}</li>
<li>BIC: 6.15557^{4}</li>
</ul>
</section>
</section>
<section id="model-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="model-coefficients">Model Coefficients</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Hurdle Model Results</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">Z_value</th>
<th style="text-align: right;">P_value</th>
<th style="text-align: left;">Sig</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">count_(Intercept)</td>
<td style="text-align: right;">-3.1605</td>
<td style="text-align: right;">0.5252</td>
<td style="text-align: right;">-6.02</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_log_AADT</td>
<td style="text-align: right;">0.0284</td>
<td style="text-align: right;">0.0147</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">0.05336</td>
<td style="text-align: left;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_road_typeMajor</td>
<td style="text-align: right;">1.3791</td>
<td style="text-align: right;">0.4439</td>
<td style="text-align: right;">3.11</td>
<td style="text-align: right;">0.00189</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_road_typeMinor</td>
<td style="text-align: right;">0.5238</td>
<td style="text-align: right;">0.4531</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">0.24768</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_speed_limit</td>
<td style="text-align: right;">0.0083</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;">7.37</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_pct_forest</td>
<td style="text-align: right;">0.0099</td>
<td style="text-align: right;">0.0025</td>
<td style="text-align: right;">4.01</td>
<td style="text-align: right;">0.00006</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_pct_farmland</td>
<td style="text-align: right;">-0.0055</td>
<td style="text-align: right;">0.0023</td>
<td style="text-align: right;">-2.44</td>
<td style="text-align: right;">0.01457</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">count_pct_residential</td>
<td style="text-align: right;">0.0027</td>
<td style="text-align: right;">0.0028</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.33541</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_pct_park</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0041</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.73732</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_(Intercept)</td>
<td style="text-align: right;">-5.8268</td>
<td style="text-align: right;">0.1567</td>
<td style="text-align: right;">-37.19</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_log_AADT</td>
<td style="text-align: right;">0.0032</td>
<td style="text-align: right;">0.0073</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.66214</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_road_typeMajor</td>
<td style="text-align: right;">1.5628</td>
<td style="text-align: right;">0.1124</td>
<td style="text-align: right;">13.90</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_road_typeMinor</td>
<td style="text-align: right;">0.3397</td>
<td style="text-align: right;">0.1161</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">0.00344</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_speed_limit</td>
<td style="text-align: right;">0.0064</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">12.83</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_pct_forest</td>
<td style="text-align: right;">0.0311</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;">28.17</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_pct_farmland</td>
<td style="text-align: right;">0.0214</td>
<td style="text-align: right;">0.0010</td>
<td style="text-align: right;">21.68</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_pct_residential</td>
<td style="text-align: right;">-0.0137</td>
<td style="text-align: right;">0.0012</td>
<td style="text-align: right;">-11.49</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_pct_park</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;">0.0021</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.67786</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation-guide" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-guide">Interpretation guide:</h4>
<ul>
<li><p><strong>Zero component</strong>: Coefficients are log-odds. Positive → increases probability of roadkill occurring</p></li>
<li><p><strong>Count component</strong>: Coefficients are on log scale. Positive → increases expected count given occurrence</p></li>
<li><p><strong>Significance</strong>: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05</p></li>
</ul>
</section>
</section>
<section id="hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h3>
<section id="h1-traffic-volume-effect" class="level4">
<h4 class="anchored" data-anchor-id="h1-traffic-volume-effect">H1: Traffic Volume Effect</h4>
<p><strong>Occurrence component:</strong></p>
<ul>
<li><p>Coefficient: 0.0032, SE: 0.0073, p = 0.66214</p></li>
<li><p>Result: Traffic does not significantly affect roadkill probability</p></li>
</ul>
<p><strong>Intensity component:</strong></p>
<ul>
<li><p>Coefficient: 0.0284, SE: 0.0147, p = 0.05336 .</p></li>
<li><p>Result: Traffic does not significantly affect collision intensity</p></li>
</ul>
<p><strong>Effect size:</strong> A 10% increase in traffic volume:</p>
<ul>
<li><p>Changes odds of occurrence by 0%</p></li>
<li><p>Changes expected count by 0.3%</p></li>
</ul>
<p><strong>H1 Status:</strong> NOT SUPPORTED</p>
</section>
<section id="h2-land-use-effects" class="level4">
<h4 class="anchored" data-anchor-id="h2-land-use-effects">H2: Land Use Effects</h4>
<section id="h2a-forestpark-habitat" class="level5">
<h5 class="anchored" data-anchor-id="h2a-forestpark-habitat">H2a: Forest/Park habitat</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 6^{-5} ***</p>
<p>Forest coverage significantly affects roadkill patterns.</p>
</section>
<section id="h2b-residential-development" class="level5">
<h5 class="anchored" data-anchor-id="h2b-residential-development">H2b: Residential development</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 0.33541</p>
<p>Residential areas show negative association (as predicted).</p>
<p>H2 Status: <strong>SUPPORTED</strong></p>
</section>
</section>
<section id="h3-road-characteristics" class="level4">
<h4 class="anchored" data-anchor-id="h3-road-characteristics">H3: Road Characteristics</h4>
<section id="h3a-major-roads" class="level5">
<h5 class="anchored" data-anchor-id="h3a-major-roads">H3a: Major roads</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 0.00189 **</p>
<p>Major roads have higher roadkill rates than minor roads.</p>
</section>
<section id="h3b-speed-limit" class="level5">
<h5 class="anchored" data-anchor-id="h3b-speed-limit">H3b: Speed limit</h5>
<p>Occurrence: p = 0 *** | Intensity: p = 0 ***</p>
<p>Speed limit significantly affect s collision risk.</p>
<p>H3 Status: <strong>SUPPORTED</strong></p>
</section>
</section>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<section id="summary-of-findings" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-findings">Summary of Findings</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Hypothesis Test Results (+ positive effect, − negative effect, NS not significant)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Hypothesis</th>
<th style="text-align: left;">Occurrence</th>
<th style="text-align: left;">Intensity</th>
<th style="text-align: left;">Support</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H1: Traffic</td>
<td style="text-align: left;">NS</td>
<td style="text-align: left;">NS</td>
<td style="text-align: left;">✗</td>
</tr>
<tr class="even">
<td style="text-align: left;">H2a: Forest</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H2b: Residential</td>
<td style="text-align: left;">−</td>
<td style="text-align: left;">NS</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="even">
<td style="text-align: left;">H3a: Major roads</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">✓</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H3b: Speed</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">✓</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="policy-implications" class="level3">
<h3 class="anchored" data-anchor-id="policy-implications">Policy Implications</h3>
<p>Our findings suggest several evidence-based mitigation strategies:</p>
<ol type="1">
<li><p><strong>Traffic management</strong>: Roads with AADT &gt; 2,853 vehicles/day (75th percentile) near natural habitats are high-priority for wildlife warning systems</p></li>
<li><p><strong>Targeted interventions</strong>: Focus mitigation efforts (wildlife crossings, fencing) on:</p></li>
</ol>
<ul>
<li><p>High-traffic corridors adjacent to forests/parks</p></li>
<li><p>Major highways with speed limits ≥80 km/h</p></li>
<li><p>Areas where predicted collision probability exceeds threshold</p></li>
</ul>
<ol start="3" type="1">
<li><strong>Land use planning</strong>: Consider roadkill risk when approving development near wildlife habitat</li>
</ol>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ol type="1">
<li><p><strong>Spatial coverage</strong>: Analysis limited to roads near traffic monitoring (~75% of network)</p></li>
<li><p><strong>Species aggregation</strong>: All species combined; taxa-specific patterns not explored</p></li>
<li><p><strong>Temporal aggregation</strong>: Seasonal/daily variation not modeled; OSM data used from 2024, AADT data from 2019, and roadkill occurrences from 2017-2019</p></li>
<li><p><strong>Unmeasured confounders</strong>: Wildlife population density, driver behavior not available, presence of overpasses/other corridors, visibility on roads.</p></li>
</ol>
<section id="conclusions" class="level4">
<h4 class="anchored" data-anchor-id="conclusions">Conclusions</h4>
<p>This analysis demonstrates how hurdle models handle zero-inflated ecological count data by separately modeling occurrence and intensity processes. We identified traffic volume, land use composition, and road characteristics as key predictors of wildlife-vehicle collisions on Danish roads.</p>
<p>Key contributions:</p>
<ul>
<li><p>Methodological framework for zero-inflated spatial count data</p></li>
<li><p>Quantified effects of infrastructure and landscape on roadkill risk</p></li>
<li><p>Policy-relevant findings for targeted mitigation</p></li>
</ul>
<p>The hurdle model approach extends beyond roadkill to any ecological phenomenon with excess zeros: rare species observations, disease outbreaks, extreme weather events, or pollution violations.</p>
</section>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-vejdirektoratet2019" class="csl-entry" role="listitem">
Danish Road Directorate. 2017--2019. <span>“Traffic Counts – Key Figures (MASTRA).”</span> <a href="https://www.opendata.dk/vejdirektoratet/taellinger-nogletal-mastra" class="uri">https://www.opendata.dk/vejdirektoratet/taellinger-nogletal-mastra</a>.
</div>
<div id="ref-grilo2025" class="csl-entry" role="listitem">
Grilo, Clara, Tomé Neves, Jennifer Bates, Aliza le Roux, Pablo Medrano-Vizcaíno, Mattia Quaranta, Inês Silva, et al. 2025. <span>“Global Roadkill Data: A Dataset on Terrestrial Vertebrate Mortality Caused by Collision with Vehicles.”</span> figshare. <a href="https://doi.org/10.6084/M9.FIGSHARE.25714233">https://doi.org/10.6084/M9.FIGSHARE.25714233</a>.
</div>
<div id="ref-osm2024" class="csl-entry" role="listitem">
OpenStreetMap contributors. 2024. <span>“Planet Dump Retrieved from Https://Planet.openstreetmap.org.”</span> <a href="https://www.openstreetmap.org" class="uri">https://www.openstreetmap.org</a>.
</div>
</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{miller2025,
  author = {Miller, Emily},
  title = {Traffic, {Land} {Use,} and {Wildlife-Vehicle} {Collisions} in
    {Denmark}},
  date = {2025-11-29},
  url = {https://rellimylime.github.io/posts/eds222-final/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-miller2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Miller, Emily. 2025. <span>“Traffic, Land Use, and Wildlife-Vehicle
Collisions in Denmark.”</span> November 29, 2025. <a href="https://rellimylime.github.io/posts/eds222-final/">https://rellimylime.github.io/posts/eds222-final/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>